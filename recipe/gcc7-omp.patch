diff --git a/src/disp/dftd4.f90 b/src/disp/dftd4.f90
index ec043ac..5b071b8 100644
--- a/src/disp/dftd4.f90
+++ b/src/disp/dftd4.f90
@@ -924,7 +924,7 @@ subroutine weight_references(dispm, nat, atoms, g_a, g_c, wf, q, cn, &
    zerodcn = 0.0_wp
    zetadq  = 0.0_wp
 
-   !$omp parallel do default(none) shared(zetavec, zetadcn, zetadq, zerodcn) &
+   !$omp parallel do default(shared) shared(zetavec, zetadcn, zetadq, zerodcn) &
    !$omp shared(nat, atoms, zeff, gam, dispm, cn, q) &
    !$omp private(iat, ati, zi, gi, norm, dnorm, iref, icount, twf, gw, expw, &
    !$omp& expd, gwk, dgwk)
@@ -1932,10 +1932,10 @@ subroutine atm_gradient_latp &
 
    cutoff2 = cutoff**2
 
-   !$omp parallel do default(none) reduction(+energies, gradient, sigma, dEdcn) &
+   !$omp parallel do default(none) reduction(+:energies, gradient, sigma, dEdcn) &
    !$omp shared(mol, r4r2, par, trans, cutoff2) &
    !$omp private(iat, ati, jat, atj, kat, atk, c6ij, cij, c6ik, c6jk, cik, cjk, &
-   !$omp& itr, rij, r2ij, ktr, rik, r2ik, rjk, r2jk, scale, dE, dG, dS, dCN)
+   !$omp& rij, r2ij, ktr, rik, r2ik, rjk, r2jk, scale, dE, dG, dS, dCN)
    do iat = 1, len(mol)
       ati = mol%at(iat)
       do jat = 1, iat
